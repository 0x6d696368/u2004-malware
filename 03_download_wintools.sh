#!/bin/bash
echo Needs sudo
sudo echo thx
sudo apt install git wget tar unzip unrar p7zip

# download some windows tools
TOOLSDIR="mal-tools"
mkdir -p ${TOOLSDIR}
cd ${TOOLSDIR}

# flare-vm
mkdir flare-vm
git clone https://github.com/fireeye/flare-vm

# sysinternals
mkdir -p sysinternals
cd sysinternals
wget https://download.sysinternals.com/files/SysinternalsSuite.zip
unzip SysinternalsSuite.zip
cd ..

# ProcMonX
mkdir -p ProcMonX
cd ProcMonX
wget https://github.com/zodiacon/ProcMonX/releases/download/0.21-beta/ProcMonX.0.21.zip
unzip ProcMonX.0.21.zip
wget https://go.microsoft.com/fwlink/?linkid=2088631 -O ndp48-x86-x64-allos-enu.exe
cd ..

# DriverMon
mkdir -p DriverMon
cd DriverMon
wget https://github.com/zodiacon/DriverMon/releases/download/0.31beta/DriverMon.zip
unzip DriverMon.zip
cd ..

# fakenet
mkdir -p fakenet
cd fakenet
wget https://sourceforge.net/projects/fakenet/files/latest/download -O fakenet.zip
unzip fakenet.zip
cd ..

# ida
mkdir -p ida
cd ida
# ida5 free from https://www.scummvm.org/news/20180331/
wget https://www.scummvm.org/frs/extras/IDA/idafree50.exe
# ida7 free from https://www.hex-rays.com/products/ida/support/download_freeware.shtml
wget https://out7.hex-rays.com/files/idafree70_windows.exe
wget https://out7.hex-rays.com/files/idafree70_linux.run
wget https://out7.hex-rays.com/files/idafree70_mac.tgz
cd ..

# ollydbg
mkdir -p ollydbg
cd ollydbg
# odbg 1.10
wget http://www.ollydbg.de/odbg110.zip
unzip odbg110.zip -d odbg110
# plugins
wget http://www.openrce.org/downloads/download_file/111 -O SV_IsDebug14.zip
unzip SV_IsDebug14.zip -d odbg110/.
# odbg 2.01
wget http://www.ollydbg.de/odbg201.zip
unzip odbg201.zip -d odbg201
# Disasm 2.01
wget http://www.ollydbg.de/Disasm201.zip
unzip Disasm201.zip -d Disasm201
cd ..

# radare2
mkdir -p radare2
cd radare2
wget https://github.com/radare/radare2/releases/download/3.2.1/radare2_installer-msvc_32-3.2.1.exe
wget https://github.com/radare/radare2/releases/download/3.2.1/radare2_installer-msvc_64-3.2.1.exe
wget https://download.microsoft.com/download/6/A/A/6AA4EDFF-645B-48C5-81CC-ED5963AEAD48/vc_redist.x86.exe
wget https://download.microsoft.com/download/6/A/A/6AA4EDFF-645B-48C5-81CC-ED5963AEAD48/vc_redist.x64.exe
cd ..

# windbg 
mkdir -p windbg
cd windbg

mkdir -p winxp
cd winxp
wget https://codemachine.com/downloads/winxp/dbg_x86_6.0.17.0.msi
cd ..
mkdir -p win7
cd win7
wget https://codemachine.com/downloads/win71/dbg_amd64_6.12.2.633.msi
wget https://codemachine.com/downloads/win71/dbg_x86_6.12.2.633.msi
cd ..
mkdir -p win10
cd win10
wget https://codemachine.com/downloads/win10/X64%20Debuggers%20And%20Tools-x64_en-us.msi
wget https://codemachine.com/downloads/win10/X86%20Debuggers%20And%20Tools-x86_en-us.msi 
cd ..
mkdir -p win10th2
cd win10th2
wget https://codemachine.com/downloads/win10th2/X64%20Debuggers%20And%20Tools-x64_en-us.msi
wget https://codemachine.com/downloads/win10th2/X86%20Debuggers%20And%20Tools-x86_en-us.msi
cd ..
mkdir -p win10th3
cd win10th3
wget https://codemachine.com/downloads/win10rs1/X64%20Debuggers%20And%20Tools-x64_en-us.msi
wget https://codemachine.com/downloads/win10rs1/X86%20Debuggers%20And%20Tools-x86_en-us.msi
cd ..

# wdgbgark
mkdir -p wdgbgark
cd wdgbgark 
wget https://github.com/swwwolf/wdbgark/releases/download/alpha/wdbgark-dev.zip
unzip wdbgark-dev.zip
cd ..

# SwishDbgExt
mkdir -p SwishDbgExt
cd SwishDbgExt
wget https://github.com/comaeio/SwishDbgExt/releases/download/v3.0.20180330.1/SwishDbgExt-3.0.20180330.1.zip
unzip SwishDbgExt-3.0.20180330.1.zip
cd ..

# DbgKit
mkdir -p DbgKit
cd DbgKit
wget http://www.andreybazhan.com/download/DbgKit.zip
unzip DbgKit.zip
cd ..

# exit windbg
cd ..

# shellcode launcher
mkdir -p shellcode_launcher
cd shellcode_launcher
wget https://github.com/clinicallyinane/shellcode_launcher/raw/master/shellcode_launcher.exe
cd ..

# osr driver loader
mkdir -p osrloader
cd osrloader
wget "http://www.osronline.com/OsrDown.cfm/osrloaderv30.zip?name=osrloaderv30.zip&id=157" -O osrloaderv30.zip
unzip osrloaderv30.zip
cd ..

# PMA Starter Kit
mkdir -p PMAStarterKit
cd PMAStarterKit
wget https://bluesoul.me/files/PMAStarterKit.zip
unzip -P malware PMAStarterKit.zip
cd ..


# tools from hasherezade
mkdir -p hasherezade
cd hasherezade

# pe-sieve
mkdir -p pe-sieve
cd pe-sieve
wget https://github.com/hasherezade/pe-sieve/releases/download/v0.1.6/pe-sieve32.exe
wget https://github.com/hasherezade/pe-sieve/releases/download/v0.1.6/pe-sieve64.exe
cd ..

# hollows-hunter
mkdir -p hollows-hunter
cd hollows-hunter
wget https://github.com/hasherezade/hollows_hunter/releases/download/v0.1.9/hollows_hunter32.zip
unzip hollows_hunter32.zip -d hollows_hunter32
wget https://github.com/hasherezade/hollows_hunter/releases/download/v0.1.9/hollows_hunter64.zip
unzip hollows_hunter64.zip -d hollows_hunter64
cd ..

# IAT_Patcher
mkdir -p IAT_Patcher
cd IAT_Patcher
wget https://github.com/hasherezade/IAT_patcher/releases/download/v3.5.2/IAT_Patcher_x64.zip
unzip IAT_Patcher_x64.zip -d IAT_Patcher_x64
wget https://github.com/hasherezade/IAT_patcher/releases/download/v3.5.2/IAT_Patcher_x86.zip
unzip IAT_Patcher_x86.zip -d IAT_Patcher_x86
wget https://github.com/hasherezade/IAT_patcher/files/1485930/vc_redist.x64.zip
unzip vc_redist.x64.zip
wget https://github.com/hasherezade/IAT_patcher/files/1485931/vc_redist.x86.zip
unzip vc_redist.x86.zip
cd ..

# hasherezade/mal_unpack
mkdir -p mal_unpack
cd mal_unpack
wget https://goo.gl/ShvVWu -O mal_unpack32.zip
unzip mal_unpack32.zip -d mal_unpack32
wget https://goo.gl/92fx4P -O mal_unpack64.zip
unzip mal_unpack64.zip -d mal_unpack64
cd ..

# PE-bear
mkdir -p PE-bear
cd PE-bear
wget https://github.com/hasherezade/releases/files/1868612/vcredist_x64.zip
unzip vcredist_x64.zip
wget https://github.com/hasherezade/releases/files/1868613/vcredist_x86.zip
unzip vcredist_x86.zip
wget https://github.com/hasherezade/pe-bear-releases/releases/download/0.3.9.5/PE-bear_linux64.tar.gz
mkdir PE-bear_linux64
tar -xf PE-bear_linux64.tar.gz -C PE-bear_linux64
wget https://github.com/hasherezade/pe-bear-releases/releases/download/0.3.9.5/PE-bear_x64_0.3.9.5.zip
unzip PE-bear_x64_0.3.9.5.zip -d PE-bear_x64_0.3.9.5
wget https://github.com/hasherezade/pe-bear-releases/releases/download/0.3.9.5/PE-bear_x86_0.3.9.5.zip
unzip PE-bear_x86_0.3.9.5.zip -d PE-bear_x86_0.3.9.5
cd ..

# exit hasherezade
cd ..

# PEiD
mkdir -p PEiD
cd PEiD
wget https://softpedia-secure-download.com/dl/87f384e7c27b169d605a604410552583/5c765f6f/100004102/software/programming/PEiD-0.95-20081103.zip
unzip PEiD-0.95-20081103.zip
cd ..

# Fireeye floss
mkdir -p floss
cd floss
wget https://github.com/fireeye/flare-floss/releases/download/v1.5.0/floss-1.5.0-Microsoft.Windows32.zip
unzip floss-1.5.0-Microsoft.Windows32.zip -d floss-1.5.0-Microsoft.Windows32
wget https://github.com/fireeye/flare-floss/releases/download/v1.5.0/floss-1.5.0-Microsoft.Windows64.zip
unzip floss-1.5.0-Microsoft.Windows64.zip -d floss-1.5.0-Microsoft.Windows64
wget https://github.com/fireeye/flare-floss/releases/download/v1.5.0/floss-1.5.0-GNU.Linux.zip
unzip floss-1.5.0-GNU.Linux.zip -d floss-1.5.0-GNU.Linux
wget https://github.com/fireeye/flare-floss/releases/download/v1.5.0/floss-1.5.0-OSX.zip
unzip floss-1.5.0-OSX.zip -d floss-1.5.0-OSX
cd ..

# HxD
mkdir -p HxD
cd HxD
wget https://mh-nexus.de/downloads/HxDSetup.zip
unzip HxDSetup.zip
cd ..

# LordPE
mkdir -p LordPE
cd LordPE
wget http://www.woodmann.com/collaborative/tools/images/Bin_LordPE_2010-6-29_3.9_LordPE_1.41_Deluxe_b.zip
unzip Bin_LordPE_2010-6-29_3.9_LordPE_1.41_Deluxe_b.zip
unzip LPE-DLX_1.4.zip -d LPE-DLX_1.4
unzip LPE-DLXb_1.41_UPD.zip -d LPE-DLXb_1.41_UPD
cd ..

# immunity debugger
mkdir -p ImmunityDebugger
cd ImmunityDebugger
wget https://softpedia-secure-download.com/dl/d72a1893517413f35dec437de70d5886/5c770514/100161783/software/programming/ImmunityDebugger_1_85_setup.exe
7z ImmunityDebugger_1_85_setup.exe
cd ..

# x64dgb
mkdir -p x64dbg
cd x64dbg

wget https://github.com/x64dbg/x64dbg/releases/download/snapshot/snapshot_2019-10-23_12-30.zip
unzip snapshot_2019-10-23_12-30.zip
# ScyllaHide
wget https://github.com/x64dbg/ScyllaHide/releases/download/snapshot/ScyllaHide_2019-03-11_20-38.7z
mkdir -p release/x32/plugins
mkdir -p release/x64/plugins
7z x ScyllaHide_2019-03-11_20-38.7z -o ScyllaHide
cp ScyllaHide/Release/{scylla_hide.ini,NtApiCollection.ini,HookLibraryx86.dll} ScyllaHide/Release/plugins/ScyllaHideX64DBGPlugin.dp32 release/x32/plugins/.
cp ScyllaHide/Release/{scylla_hide.ini,NtApiCollection.ini,HookLibraryx64.dll} ScyllaHide/Release/plugins/ScyllaHideX64DBGPlugin.dp64 release/x64/plugins/.
# OllyDumpEx
wget https://low-priority.appspot.com/ollydumpex/OllyDumpEx.zip
unzip OllyDumpEx.zip
cp OllyDumpEx_v*/OllyDumpEx_X64Dbg.dp32 release/x32/plugins/.
cp OllyDumpEx_v*/OllyDumpEx_X64Dbg.dp64 release/x64/plugins/.
# YaraGen
wget https://github.com/mrexodia/YaraGen/releases/download/v0.1/YaraGen.dp32
cp YaraGen.dp32 release/x32/plugins/.
wget https://github.com/mrexodia/YaraGen/releases/download/v0.1/YaraGen.dp64
cp YaraGen.dp64 release/x64/plugins/.
# Api-Break-for-x64dbg
wget https://github.com/0ffffffffh/Api-Break-for-x64dbg/releases/download/BETA/x64dbgApiBreak.dp32
cp x64dbgApiBreak.dp32 release/x32/plugins/.
wget https://github.com/0ffffffffh/Api-Break-for-x64dbg/releases/download/BETA/x64dbgApiBreak.dp64
cp x64dbgApiBreak.dp64 release/x64/plugins/.
# DbgChild
wget https://github.com/David-Reguera-Garcia-Dreg/DbgChild/releases/download/beta10/DbgChild.Beta.10.zip
unzip DbgChild.Beta.10.zip
cp -r DbgChild\ Beta\ 10/release/* release/.
# nfdx64dbg
wget https://github.com/horsicq/nfdx64dbg/releases/download/0.06/release.zip -O nfdx64dbg.zip
unzip nfdx64dbg.zip -d nfdx64dbg
cp -r nfdx64dbg/release/* release/.

# exit x64dbg
cd ..

# ghidra
mkdir -p ghidra
cd ghidra
wget wget https://github.com/NationalSecurityAgency/ghidra/archive/Ghidra_9.0.2_build.zip
unzip Ghidra_9.0.2_build.zip
wget https://download.java.net/java/GA/jdk11/9/GPL/openjdk-11.0.2_windows-x64_bin.zip
unzip openjdk-11.0.2_windows-x64_bin.zip
mkdir -p pdb
cd pdb
wget https://go.microsoft.com/fwlink/?LinkId=746572 -o VC_redist64.exe
git clone https://github.com/MalwareTech/MSDIA-x64
cd .. # exit pdb
# exit ghidra
cd ..


# pafish
mkdir -p pafish
cd pafish
wget https://github.com/a0rtega/pafish/raw/master/pafish.exe
cd ..

# processhacker
mkdir -p processhacker
cd processhacker
wget https://github.com/processhacker/processhacker/releases/download/v2.39/processhacker-2.39-bin.zip
unzip processhacker-2.39-bin.zip
cd ..

# DIE
mkdir -p die
cd die
wget https://github.com/horsicq/DIE-engine/releases/download/2.02/die_win32_portable_2.02.zip
unzip die_win32_portable_2.02.zip
wget https://github.com/horsicq/DIE-engine/releases/download/2.02/die_winxp_portable_2.02.zip
unzip die_winxp_portable_2.02.zip
wget https://github.com/horsicq/DIE-engine/releases/download/2.02/die_lin64_portable_2.02.tar.gz
tar -xvf die_lin64_portable_2.02.tar.gz
wget https://github.com/horsicq/DIE-engine/releases/download/2.02/die_mac_portable_2.02.dmg
wget https://github.com/horsicq/DIE-engine/releases/download/2.02/die_mac_portable_2.02.zip
unzip die_mac_portable_2.02.zip
cd ..

# yara
mkdir -p yara 
cd yara
wget https://www.dropbox.com/sh/umip8ndplytwzj1/AAATdLgeg_-_d4QfTdkkowaIa/yara-3.9.0-win32.zip
unzip yara-3.9.0-win32.zip -d yara-3.9.0-win32
wget https://www.dropbox.com/sh/umip8ndplytwzj1/AAAk2e9BYo-JudtgMXZZOL0Ka/yara-3.9.0-win64.zip
unzip yara-3.9.0-win64.zip -d yara-3.9.0-win64 
cd ..

# loki
mkdir -p loki
cd loki
wget https://github.com/Neo23x0/Loki/releases/download/v0.29.2/loki_0.29.2.zip
unzip loki_0.29.2.zip
cd ..


# winpmem
mkdir -p winpmem
cd winpmem
wget https://github.com/google/rekall/releases/download/v1.5.1/winpmem-2.1.post4.exe
cd ..


# wireshark
mkdir -p wireshark
cd wireshark
wget https://1.na.dl.wireshark.org/win32/WiresharkPortable_3.0.1.paf.exe
wget https://1.na.dl.wireshark.org/win64/Wireshark-win64-3.0.1.exe
wget https://1.na.dl.wireshark.org/win32/Wireshark-win32-3.0.1.exe
wget https://www.winpcap.org/install/bin/WinPcap_4_1_3.exe
cd ..

# dnSpy
mkdir -p dnSpy
cd dnSpy
wget https://github.com/0xd4d/dnSpy/releases/download/v6.0.5/dnSpy-netcore-win64.zip
unzip dnSpy-netcore-win64.zip -d dnSpy-netcore-win64
wget https://github.com/0xd4d/dnSpy/releases/download/v6.0.5/dnSpy-netcore-win32.zip
unzip dnSpy-netcore-win32.zip -d dnSpy-netcore-win32
wget https://aka.ms/vs/16/release/vc_redist.x86.exe
wget https://aka.ms/vs/16/release/vc_redist.x64.exe

wget https://github.com/0xd4d/dnSpy/releases/download/v6.0.5/dnSpy-net472.zip
unzip dnSpy-net472.zip -d dnSpy-net472
cd ..


# upx
mkdir -p upx
cd upx
wget https://github.com/upx/upx/releases/download/v3.95/upx-3.95-win32.zip
unzip upx-3.95-win32.zip -d upx-3.95-win32
wget https://github.com/upx/upx/releases/download/v3.95/upx-3.95-win64.zip
unzip upx-3.95-win64.zip -d upx-3.95-win64
cd ..

# exit tools dir
cd ..


